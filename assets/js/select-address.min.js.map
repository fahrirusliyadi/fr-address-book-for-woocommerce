{"version":3,"sources":["select-address.js"],"names":["$","SelectAddress","this","$document","document","prototype","init","_initFieldValues","on","proxy","onChangeBillingSelect","onChangeShippingSelect","event","$selectedField","target","_toggleFields","_updateFieldValues","$selectedBillingField","$selectedShippingField","type","addressId","val","toggleClass","$form","closest","address","fabfw_select_address","addresses","each","key","value","$field","find","length","is","append","trigger","jQuery"],"mappings":"CAQA,SAAUA,GACN,aAQA,SAASC,IACLC,KAAKC,UAAYH,EAAEI,UASvBH,EAAcI,UAAUC,KAAO,WAC3BJ,KAAKK,mBAELL,KAAKC,UAAUK,GAAG,eAAgB,oCAAqCR,EAAES,MAAMP,KAAKQ,sBAAuBR,OAC3GA,KAAKC,UAAUK,GAAG,eAAgB,qCAAsCR,EAAES,MAAMP,KAAKS,uBAAwBT,QAUjHD,EAAcI,UAAUK,sBAAwB,SAASE,GACrD,IAAIC,EAAiBb,EAAEY,EAAME,QAE7BZ,KAAKa,cAAc,UAAWF,GAC9BX,KAAKc,mBAAmB,UAAWH,IAUvCZ,EAAcI,UAAUM,uBAAyB,SAASC,GACtD,IAAIC,EAAiBb,EAAEY,EAAME,QAE7BZ,KAAKa,cAAc,WAAYF,GAC/BX,KAAKc,mBAAmB,WAAYH,IASxCZ,EAAcI,UAAUE,iBAAmB,WACvC,IAAIU,EAA0BjB,EAAE,6CAC5BkB,EAA0BlB,EAAE,8CAEhCE,KAAKa,cAAc,UAAWE,GAC9Bf,KAAKa,cAAc,WAAYG,GAC/BhB,KAAKc,mBAAmB,UAAWC,GACnCf,KAAKc,mBAAmB,WAAYE,IAYxCjB,EAAcI,UAAUU,cAAgB,SAASI,EAAMN,GACnD,IAAIO,EAAYP,EAAeQ,MAE/BrB,EAAE,gBAAkBmB,EAAO,0BAA0BG,YAAY,SAAwB,QAAdF,IAW/EnB,EAAcI,UAAUW,mBAAqB,SAASG,EAAMN,GACxD,IAAIU,EAAkBV,EAAeW,QAAQ,QACzCC,EAAkBC,qBAAqBC,UAAUd,EAAeQ,OAE/DI,GAILzB,EAAE4B,KAAKH,EAAS,SAASI,EAAKC,GAC1B,IAAIC,EAASR,EAAMS,KAAK,IAAMb,EAAO,IAAMU,GAEtCE,EAAOE,QAAUF,EAAOV,QAAUS,IAKnCC,EAAOG,GAAG,YAAcH,EAAOC,KAAK,iBAAmBF,EAAQ,MAAMG,QACrEF,EAAOI,OAAO,kBAAoBL,EAAQ,KAAOA,EAAQ,aAG7DC,EAAOV,IAAIS,GAGXC,EAAOK,QAAQ,eAIvB,IAAInC,GAAgBK,OAxHxB,CA0HG+B","file":"select-address.min.js","sourcesContent":["/* global fabfw_select_address */\n/**\n * Select address script on checkout page.\n * \n * @since 1.0.0\n * @param {jQuery} $\n * @returns {undefined}\n */\n(function($) {\n    \"use strict\";\n    \n    /**\n     * Select address class.\n     * \n     * @since 1.0.0\n     * @returns {SelectAddress}\n     */\n    function SelectAddress() {\n        this.$document = $(document);\n    }\n    \n    /**\n     * Initialize.\n     * \n     * @since 1.0.0\n     * @returns {undefined}\n     */\n    SelectAddress.prototype.init = function() {\n        this._initFieldValues();\n        \n        this.$document.on('change.fabfw', '[name=\"fabfw_address_billing_id\"]', $.proxy(this.onChangeBillingSelect, this));\n        this.$document.on('change.fabfw', '[name=\"fabfw_address_shipping_id\"]', $.proxy(this.onChangeShippingSelect, this));\n    };\n    \n    /**\n     * Change event handler for select billing address field.\n     * \n     * @since 1.0.0\n     * @param {Event} event\n     * @returns {undefined}\n     */\n    SelectAddress.prototype.onChangeBillingSelect = function(event) {\n        var $selectedField = $(event.target);\n        \n        this._toggleFields('billing', $selectedField);\n        this._updateFieldValues('billing', $selectedField);\n    };\n    \n    /**\n     * Change event handler for select shipping address field.\n     * \n     * @since 1.0.0\n     * @param {Event} event\n     * @returns {undefined}\n     */\n    SelectAddress.prototype.onChangeShippingSelect = function(event) {\n        var $selectedField = $(event.target);\n        \n        this._toggleFields('shipping', $selectedField);\n        this._updateFieldValues('shipping', $selectedField);\n    };\n    \n    /**\n     * Initialize address field values on load.\n     * \n     * @since 1.0.0\n     * @returns {undefined}\n     */\n    SelectAddress.prototype._initFieldValues = function() {        \n        var $selectedBillingField   = $('[name=\"fabfw_address_billing_id\"]:checked');\n        var $selectedShippingField  = $('[name=\"fabfw_address_shipping_id\"]:checked');\n        \n        this._toggleFields('billing', $selectedBillingField);\n        this._toggleFields('shipping', $selectedShippingField);\n        this._updateFieldValues('billing', $selectedBillingField);\n        this._updateFieldValues('shipping', $selectedShippingField);\n    };\n    \n    /**\n     * Show the address fields if the customer wants to add a new address, otherwise\n     * hide it.\n     * \n     * @since 1.0.0\n     * @param {string} type Address type (billing|shipping).\n     * @param {jQuery} $selectedField\n     * @returns {undefined}\n     */\n    SelectAddress.prototype._toggleFields = function(type, $selectedField) {\n        var addressId = $selectedField.val();\n        \n        $('.woocommerce-' + type + '-fields__field-wrapper').toggleClass('hidden', addressId !== 'new');\n    };\n    \n    /**\n     * Update address field values.\n     * \n     * @since 1.0.0\n     * @param {string} type Address type (billing|shipping).\n     * @param {jQuery} $selectedField\n     * @returns {undefined}\n     */\n    SelectAddress.prototype._updateFieldValues = function(type, $selectedField) {\n        var $form           = $selectedField.closest('form');\n        var address         = fabfw_select_address.addresses[$selectedField.val()];\n        \n        if (!address) {\n            return;\n        }\n        \n        $.each(address, function(key, value) {\n            var $field = $form.find('#' + type + '_' + key);\n            \n            if (!$field.length || $field.val() === value) {\n                return;\n            }\n            \n            // Create the select option if it does not exists yet.\n            if ($field.is('select') && !$field.find('option[value=\"' + value + '\"]').length) {\n                $field.append('<option value=\"' + value + '\">' + value + '</option>');\n            }\n            \n            $field.val(value);\n            // `onchange` only fires when the user types into the input and then the input loses focus.\n            // https://stackoverflow.com/a/3179392\n            $field.trigger('change');\n        });\n    };\n\n    new SelectAddress().init();\n    \n})(jQuery);"]}